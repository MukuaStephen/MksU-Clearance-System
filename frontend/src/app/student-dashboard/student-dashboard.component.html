<div class="dashboard-layout">

  <!-- ================= SIDEBAR ================= -->
  <aside class="sidebar">

    <div class="sidebar-header">
      <div class="avatar">
        <span>ST</span>
      </div>

      <h2 class="portal-name">Student Portal</h2>
      <p class="portal-subtitle">University Clearance System</p>
    </div>

    <div class="sidebar-navigation">

      <button class="nav-card" (click)="showDashboard()">
        <h4>Home</h4>
        <p>
          View your clearance progress and see which offices
          are pending, approved, or denied.
        </p>
      </button>

      <button class="nav-card" (click)="showClearance()">
        <h4>Clearance</h4>
        <p>
          Submit clearance requests to the required
          university offices.
        </p>
      </button>

      <button class="nav-card" (click)="showProfile()">
        <h4>My Profile</h4>
        <p>
          View your personal details and change
          your account password.
        </p>
      </button>

    </div>

    <div class="sidebar-footer">
      <button class="nav-card logout-card" (click)="logout()">
        <h4>Logout</h4>
        <p>Sign out and return to the student login page.</p>
      </button>
    </div>

  </aside>

  <!-- ================= CONTENT AREA ================= -->
  <main class="dashboard-content">

    <!-- ===== HOME / DASHBOARD ===== -->
    <section *ngIf="activeView === 'dashboard'">

      <h2>Clearance Progress Overview</h2>

      <p class="section-description">
        This dashboard shows your current clearance status across
        all university offices.
      </p>

      <table class="status-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Office</th>
            <th>Status</th>
            <th>Date Submitted</th>
            <th>Remark</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let record of clearanceService.getAllRecords(); let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ record.office }}</td>
            <td>
              <span class="status-badge">
                {{ record.status }}
              </span>
            </td>
            <td>
              {{ record.submittedAt ? (record.submittedAt | date:'medium') : '—' }}
            </td>
            <td>
              {{ record.status === 'Pending'
                ? 'Awaiting approval'
                : record.status === 'Approved'
                ? 'Approved successfully'
                : record.status === 'Denied'
                ? 'Denied – contact office'
                : 'Not submitted' }}
            </td>
          </tr>
        </tbody>
      </table>

    </section>

    <!-- ===== CLEARANCE ===== -->
    <section *ngIf="activeView === 'clearance'">
      <h2>Apply for Clearance</h2>

      <p class="section-description">
        Select the clearance reason and submit your request.
      </p>

      <!-- THIS WAS NOT SHOWING BEFORE – NOW IT WILL -->
      <app-student-clearance></app-student-clearance>
    </section>

    <!-- ===== PROFILE ===== -->
    <section *ngIf="activeView === 'profile'">

      <h2>My Profile</h2>

      <div class="profile-box">
        <div class="profile-details">
          <p><strong>Full Name:</strong> John Mwangi</p>
          <p><strong>Email:</strong> john.mwangi@student.mksu.ac.ke</p>
          <p><strong>Admission Number:</strong> SCE/CS/1234/2022</p>
        </div>
      </div>

      <h3>Change Password</h3>

      <div class="password-form">
        <input
          type="password"
          placeholder="Old password"
          [(ngModel)]="oldPassword"
        >

        <input
          type="password"
          placeholder="New password"
          [(ngModel)]="newPassword"
        >

        <button (click)="changePassword()">Update Password</button>

        <p class="success-message" *ngIf="passwordMessage">
          {{ passwordMessage }}
        </p>
      </div>

    </section>

  </main>

</div>
